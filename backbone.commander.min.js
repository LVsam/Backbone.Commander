(function(){var c;c=function(a,b){_.bindAll(this);this.eventMap=a?a:{};this.eventAggregator=b?b.method:App.vent;this.trigger=b?b.trigger:"trigger";this.downKeys=[];this.initListeners()};_.extend(c.prototype,{initListeners:function(){this.addEvent(document,"keydown",_.bind(function(a){this.dispatch(a)},this));this.addEvent(document,"keyup",_.bind(function(a){this.clearDownKeys()},this))},addCommand:function(a,b){if(a&&b&&!this.eventMap.hasOwnProperty(a))return this.eventMap[a]=b;throw Error("A key command and eventName are required.");
},removeCommand:function(a){a&&this.eventMap.hasOwnProperty(a)&&delete this.eventMap[a];throw Error("A command was not supplied or did not exist on the eventMap");},clearDownKeys:function(){return this.downKeys=[]},dispatch:function(a){var b=_.invert(this.keyMap);a=a.which;b=_.isUndefined(b[a.toString()])?String.fromCharCode(a).toLowerCase():b[a.toString()];this.downKeys.push(b);b=this.downKeys.join("+");return _.isUndefined(this.eventMap[b])?!1:this.eventAggregator[this.trigger](this.eventMap[b])},
addEvent:function(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent&&a.attachEvent("on"+b,function(){c(window.event)})},keyMap:{backspace:8,tab:9,clear:12,enter:13,"return":13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,"delete":46,home:36,end:35,pageup:33,pagedown:34,shift:16,alt:18,ctrl:17,meta:91}});Backbone.Commander=c}).call(this);